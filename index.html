<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agenda Quincho - Centro Asturiano</title>
  <style>
    :root {
      --azul-primario: #1e3a8a;
      --azul-gradiente: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
      --amarillo: #f59e0b;
      --amarillo-claro: #fbbf24;
      --blanco: #ffffff;
      --gris-fondo: #f1f5f9;
      --gris-texto: #475569;
      --rojo: #ef4444;
      --verde: #10b981;
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: 'Segoe UI', system-ui, sans-serif; 
      background-color: var(--gris-fondo);
      color: var(--gris-texto);
      line-height: 1.6;
    }
    
    /* Header Principal */
    .header-main {
      background: var(--azul-gradiente);
      color: white;
      padding: 40px 20px;
      text-align: center;
      border-bottom-left-radius: 30px;
      border-bottom-right-radius: 30px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    .header-logo img { width: 90px; height: 90px; border-radius: 50%; border: 3px solid var(--amarillo); margin-bottom: 15px; }

    .container { max-width: 800px; margin: -40px auto 40px; padding: 0 20px; }
    
    .card { 
      background: var(--blanco); 
      border-radius: 20px; 
      padding: 30px; 
      box-shadow: 0 10px 25px rgba(0,0,0,0.05);
      border: 1px solid #e2e8f0;
    }

    /* Modales */
    .modal { 
      display: none; position: fixed; z-index: 1000; left: 0; top: 0; 
      width: 100%; height: 100%; background: rgba(15, 23, 42, 0.9); 
      backdrop-filter: blur(8px); align-items: center; justify-content: center;
    }
    .modal.activa { display: flex; }
    .modal-content { 
      background: white; padding: 40px; border-radius: 24px; 
      width: 90%; max-width: 550px; position: relative;
      text-align: center; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5);
    }

    /* Inputs y Forms */
    .form-group { margin-bottom: 20px; text-align: left; }
    label { display: block; font-weight: 600; color: var(--azul-primario); margin-bottom: 8px; font-size: 0.95rem; }
    input, select, textarea { 
      width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; 
      font-size: 16px; transition: 0.3s; background: #f8fafc;
    }
    input:focus { border-color: var(--azul-claro); outline: none; background: white; }
    
    .grid-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
    .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }

    /* Botones */
    button { 
      background: var(--azul-gradiente); color: white; border: none; 
      padding: 16px; border-radius: 12px; font-weight: 700; cursor: pointer; 
      width: 100%; transition: transform 0.2s, box-shadow 0.2s;
    }
    button:hover { transform: translateY(-2px); box-shadow: 0 8px 15px rgba(59, 130, 246, 0.3); }
    button:disabled { background: #cbd5e1; cursor: not-allowed; transform: none; }

    .btn-copiar { background: var(--verde); width: auto; padding: 8px 15px; font-size: 0.8rem; margin-top: 10px; }

    /* Estilos de informaci√≥n */
    .total-display {
      background: #eff6ff; border: 2px dashed var(--azul-claro);
      border-radius: 15px; padding: 20px; margin: 25px 0; text-align: center;
    }
    .total-amount { font-size: 2rem; font-weight: 800; color: var(--azul-primario); }

    .item-detalle { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #f1f5f9; font-size: 0.9rem; }
    .item-total { font-weight: bold; color: var(--rojo); border-top: 2px solid #e2e8f0; padding-top: 10px; margin-top: 10px; }

    /* Alerta de Seguridad */
    .alerta-seguridad { 
      background: #fee2e2; border-left: 5px solid var(--rojo); 
      padding: 15px; border-radius: 10px; margin-bottom: 20px; font-size: 0.85rem; color: #991b1b;
      display: none;
    }

    @media (max-width: 600px) { .grid-inputs, .grid-3 { grid-template-columns: 1fr; } }
  </style>
</head>
<body>

  <div class="header-main">
    <div class="header-logo">
      <img src="https://i.ibb.co/q3d6Ktzm/logo-centro-asturiano2.png" alt="Logo Centro Asturiano">
    </div>
    <h1>Agenda de Quincho</h1>
    <p>Centro Asturiano de Buenos Aires</p>
  </div>

  <div id="modalValidacion" class="modal activa">
    <div class="modal-content">
      <img src="https://i.ibb.co/q3d6Ktzm/logo-centro-asturiano2.png" style="width: 80px; margin-bottom:10px;" alt="Logo">
      <h2 style="color: var(--azul-primario); margin-bottom: 20px;">üîê Validaci√≥n de Socio</h2>
      <div class="form-group">
        <label>N√∫mero de Socio</label>
        <input type="number" id="numSocio" placeholder="Ej: 12345">
      </div>
      <div class="form-group">
        <label>Fecha de Nacimiento</label>
        <input type="text" id="fechaNac" placeholder="DD/MM/AAAA">
      </div>
      <button onclick="validarSocio()">üöÄ Ingresar al Sistema</button>
      <p id="errorValidacion" style="color:var(--rojo); display:none; margin-top:15px; font-size:0.9rem;">‚ùå Datos incorrectos. Reintente.</p>
    </div>
  </div>

  <div class="container">
    <div id="app" class="card" style="display:none;">
      
      <div class="form-group">
        <label>¬øQu√© vas a agendar?</label>
        <select id="tipoQuincho" onchange="calcularTotal()">
          <option value="">Seleccione una opci√≥n...</option>
          <option value="cerrado">üé™ Quincho Cerrado (Max 60 pers.)</option>
          <option value="parrilla">üî• Parrillas Externas (Socio)</option>
        </select>
      </div>

      <div class="grid-inputs">
        <div class="form-group">
          <label>Fecha del Evento</label>
          <input type="text" id="fechaEvento" placeholder="DD/MM/AAAA" oninput="calcularTotal()">
        </div>
        <div class="form-group">
          <label>Invitados Totales</label>
          <input type="number" id="totalInvitados" readonly style="background:#e2e8f0" placeholder="0">
        </div>
      </div>

      <div class="grid-inputs">
        <div class="form-group">
          <label>Hora Inicio (24hs)</label>
          <input type="text" id="horaInicio" placeholder="HH:MM" oninput="calcularTotal()">
        </div>
        <div class="form-group">
          <label>Hora Fin (24hs)</label>
          <input type="text" id="horaFin" placeholder="HH:MM" oninput="calcularTotal()">
        </div>
      </div>

      <div id="alertaSeguridad" class="alerta-seguridad">
        ‚ö†Ô∏è <strong>Atenci√≥n:</strong> Horario nocturno detectado (pasado las 00:00hs). Se aplicar√° cargo de seguridad ($20.000).
      </div>

      <h3 style="margin-bottom:15px; font-size:1rem; color:var(--azul-primario)">Detalle de Invitados:</h3>
      <div class="grid-3">
        <div class="form-group"><label>Mayores</label><input type="number" id="may" value="0" min="0" oninput="calcularTotal()"></div>
        <div class="form-group"><label>Jubilados</label><input type="number" id="jub" value="0" min="0" oninput="calcularTotal()"></div>
        <div class="form-group"><label>Juveniles</label><input type="number" id="juv" value="0" min="0" oninput="calcularTotal()"></div>
        <div class="form-group"><label>Menores</label><input type="number" id="men" value="0" min="0" oninput="calcularTotal()"></div>
        <div class="form-group"><label>Infantiles</label><input type="number" id="inf" value="0" min="0" oninput="calcularTotal()"></div>
      </div>

      <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:10px;">
        <div class="checkbox-group" style="display:flex; align-items:center; gap:10px; background:#f8fafc; padding:10px; border-radius:10px;">
          <input type="checkbox" id="inflable" onchange="calcularTotal()"> <label style="margin:0">¬øTrae Inflable?</label>
        </div>
        <div class="checkbox-group" style="display:flex; align-items:center; gap:10px; background:#f8fafc; padding:10px; border-radius:10px;">
          <input type="checkbox" id="cumple" onchange="calcularTotal()"> <label style="margin:0">Es Cumplea√±ero</label>
        </div>
      </div>

      <div class="total-display">
        <p style="font-size:0.9rem; color:var(--gris-texto)">Monto Total Estimado</p>
        <div class="total-amount">ARS $<span id="montoVisual">0</span></div>
      </div>

      <button id="btnConfirmar" disabled onclick="abrirConfirmacion()">‚úÖ Revisar Detalle y Confirmar</button>
    </div>
  </div>

  <div id="modalFinal" class="modal">
    <div class="modal-content" style="text-align:left;">
      <h2 style="text-align:center; color:var(--azul-primario); margin-bottom:20px;">Resumen de la Agenda</h2>
      
      <div id="desgloseFinal" style="margin-bottom:20px;">
        </div>

      <div style="background: #f1f5f9; padding: 15px; border-radius: 12px; font-size: 0.85rem;">
        <p><strong>üè¶ Datos para Transferencia:</strong></p>
        <p>Banco Galicia | Centro Asturiano Bs As</p>
        <p>Cta Cte: 1084-1 004-4</p>
        <p><strong>CBU:</strong> 0070004720000001084140</p>
        <p><strong>Alias:</strong> CENTRO.ASTURIANO.BA</p>
        <button class="btn-copiar" onclick="copiarCBU()">üìã Copiar CBU</button>
      </div>

      <p style="font-size: 0.75rem; color: var(--rojo); margin: 15px 0;">* Deber√° enviar el comprobante por WhatsApp al finalizar.</p>
      
      <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
        <button onclick="cerrarModal('modalFinal')" style="background:#94a3b8">Volver</button>
        <button onclick="enviarDatosFinales()" style="background:var(--verde)">Confirmar Todo</button>
      </div>
    </div>
  </div>

  <script>
    // Configuraci√≥n de Tarifas
    const PRECIOS = {
      lun_jue: { m: 6200, j: 3900, juv: 5000, men: 3500 },
      vie_dom: { m: 7700, j: 4900, juv: 5500, men: 4000 },
      seguridad: 20000,
      inflable: 20000
    };

    let socioNombre = "";

    function validarSocio() {
      const socio = document.getElementById('numSocio').value;
      const fecha = document.getElementById('fechaNac').value;
      
      if(socio === "99999") { // Acceso Admin Prueba
        socioNombre = "USUARIO PRUEBA";
        document.getElementById('modalValidacion').classList.remove('activa');
        document.getElementById('app').style.display = 'block';
        return;
      }
      
      // Aqu√≠ ir√≠a el fetch real a tu Apps Script
      alert("Conectando con base de datos...");
      // Simulaci√≥n de √©xito
      socioNombre = "Socio Validado";
      document.getElementById('modalValidacion').classList.remove('activa');
      document.getElementById('app').style.display = 'block';
    }

    function calcularTotal() {
      const tipo = document.getElementById('tipoQuincho').value;
      const fechaTxt = document.getElementById('fechaEvento').value;
      const hFin = document.getElementById('horaFin').value;
      
      const m = parseInt(document.getElementById('may').value) || 0;
      const j = parseInt(document.getElementById('jub').value) || 0;
      const v = parseInt(document.getElementById('juv').value) || 0;
      const n = parseInt(document.getElementById('men').value) || 0;
      const i = parseInt(document.getElementById('inf').value) || 0;

      const totalInvitados = m + j + v + n + i;
      document.getElementById('totalInvitados').value = totalInvitados;

      if (!tipo || totalInvitados === 0) {
        document.getElementById('btnConfirmar').disabled = true;
        return;
      }

      // Determinar si es fin de semana (L√≥gica simple para ejemplo)
      const tarifas = PRECIOS.vie_dom; // Simplificado para el ejemplo

      let total = (m * tarifas.m) + (j * tarifas.j) + (v * tarifas.juv) + (n * tarifas.men);
      
      if(document.getElementById('inflable').checked) total += PRECIOS.inflable;
      
      // L√≥gica de seguridad
      const horaFinNum = parseInt(hFin.split(':')[0]) || 0;
      const nocturno = (horaFinNum >= 0 && horaFinNum < 6);
      if(nocturno) {
        total += PRECIOS.seguridad;
        document.getElementById('alertaSeguridad').style.display = 'block';
      } else {
        document.getElementById('alertaSeguridad').style.display = 'none';
      }

      // Bonificaci√≥n cumplea√±ero (Bonifica 1 mayor)
      if(document.getElementById('cumple').checked && m > 0) total -= tarifas.m;

      document.getElementById('montoVisual').innerText = total.toLocaleString('es-AR');
      document.getElementById('btnConfirmar').disabled = false;
    }

    function abrirConfirmacion() {
      const m = document.getElementById('may').value;
      const j = document.getElementById('jub').value;
      const v = document.getElementById('juv').value;
      const n = document.getElementById('men').value;
      const i = document.getElementById('inf').value;
      const total = document.getElementById('montoVisual').innerText;

      let html = `
        <div class="item-detalle"><span>Socio:</span> <span>${socioNombre}</span></div>
        <div class="item-detalle"><span>Fecha:</span> <span>${document.getElementById('fechaEvento').value}</span></div>
        <div class="item-detalle"><span>Horario:</span> <span>${document.getElementById('horaInicio').value} a ${document.getElementById('horaFin').value}hs</span></div>
        <hr style="margin:10px 0; border:0; border-top:1px solid #eee;">
        <div class="item-detalle"><span>Mayores:</span> <span>${m}</span></div>
        <div class="item-detalle"><span>Jubilados:</span> <span>${j}</span></div>
        <div class="item-detalle"><span>Juveniles:</span> <span>${v}</span></div>
        <div class="item-detalle"><span>Menores:</span> <span>${n}</span></div>
        <div class="item-detalle"><span>Infantiles:</span> <span>${i}</span></div>
        <div class="item-detalle"><span>Inflable:</span> <span>${document.getElementById('inflable').checked ? 'S√ç' : 'NO'}</span></div>
        <div class="item-detalle"><span>Seguridad Noct.:</span> <span>${document.getElementById('alertaSeguridad').style.display === 'block' ? 'S√ç' : 'NO'}</span></div>
        <div class="item-detalle item-total"><span>TOTAL A ABONAR:</span> <span>ARS $${total}</span></div>
      `;

      document.getElementById('desgloseFinal').innerHTML = html;
      document.getElementById('modalFinal').classList.add('activa');
    }

    function cerrarModal(id) { document.getElementById(id).classList.remove('activa'); }

    function copiarCBU() {
      navigator.clipboard.writeText('0070004720000001084140');
      alert("CBU copiado al portapapeles");
    }

    function enviarDatosFinales() {
      alert("¬°Agenda enviada con √©xito! Redirigiendo a WhatsApp para enviar comprobante...");
      location.reload();
    }
  </script>
</body>
</html>
